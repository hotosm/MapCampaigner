<div class="completness">
    <h3 class="progress-bar-indicator">{{ data.complete }}/{{ data.total }} ({{ data.percentage }} %)</h3>
    <div class="progress-bar-wrapper">
        <div class="progress-bar" style="width: {{ data.percentage }}%"></div>
    </div>
    <div class="see-detail" onclick="see_completeness_details(this)"><i class="fa fa-caret-down" aria-hidden="true"></i> see list of incomplete features</div>
    <table class="feature-list-table">
        <thead>
            <tr>
                <th>ID</th>
                {% for key in data.attributes %}
                    <th>{{ key }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in data.data %}
                {% if row['error'] %}
                    <tr>
                        <td><a target="_blank" href="http://www.openstreetmap.org/{{ row['type'] }}/{{ row['id'] }}">{{ row['id'] }}</a></td>
                        {% for key in data.attributes %}
                            {% if not row['tags'] %}
                                <td>-</td>
                            {% elif row['tags'][key] %}
                                <td>{{ row['tags'][key] }}</td>
                            {% elif row[key] %}
                                <td>{{ row[key] }}</td>
                            {% else %}
                                <td>-</td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
<style type="text/css">
    .see-detail {
        width: 100%;
        text-align: center;
        cursor: pointer;
        margin: 10px;
    }

    .progress-bar-indicator {
        color: #AC3232;
        margin-top: 0px;
    }

    .progress-bar-wrapper {
        background-color: #EBEBEB;
        border-radius: 50px;
        height: 10px;
    }

    .progress-bar {
        height: 10px;
        background-color: #AC3232;
        border-radius: 50px;
    }

    .completness .dataTables_wrapper {
        display: none;
    }

    .feature-list-table .error-indicator {
        background-color: #AC3232;
        color: white;
    }

    .feature-list-table .clean-indicator {
        background-color: green;
        color: white;
    }

    tr.odd:hover, tr.even:hover {
        background-color: rgba(59, 132, 172, 0.13) !important;
    }

    tr.odd {
        background-color: rgba(223, 234, 242, 0.20) !important;
    }

</style>
<script>
    $(document).ready(function () {
        $('.feature-list-table').DataTable();
    });
    function see_completeness_details(event) {
        if (!$(event).closest(".completness").find(".dataTables_wrapper").is(":visible")) {
            $(event).html('<i class="fa fa-caret-up" aria-hidden="true"></i> hide list of incomplete features');
            $(event).closest(".completness").find(".dataTables_wrapper").show();
        } else {
            $(event).html('<i class="fa fa-caret-down" aria-hidden="true"></i> see list of incomplete features');
            $(event).closest(".completness").find(".dataTables_wrapper").hide();
        }
    }
</script>